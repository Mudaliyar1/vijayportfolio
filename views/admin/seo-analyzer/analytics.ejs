<!-- Admin SEO Analyzer Analytics -->
<div class="flex flex-col md:flex-row">
  <div class="flex-grow p-6">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-2xl font-bold">SEO Analyzer Analytics</h1>
      <a href="/admin/seo-analyzer" class="bg-dark-200 hover:bg-dark-300 text-gray-300 px-3 py-2 rounded-md text-sm transition-colors">
        <i class="fas fa-arrow-left mr-1"></i> Back to Dashboard
      </a>
    </div>

    <!-- Usage Chart -->
    <div class="bg-dark-100 rounded-lg border border-gray-800 p-6 mb-8">
      <h2 class="text-xl font-semibold mb-4">Daily Usage</h2>
      <div class="h-80">
        <canvas id="usageChart"></canvas>
      </div>
    </div>

    <!-- Analytics Filters -->
    <div class="bg-dark-100 rounded-lg border border-gray-800 p-6 mb-8">
      <div class="flex flex-wrap justify-between items-center mb-4">
        <h2 class="text-xl font-semibold">Usage Filters</h2>
        <div class="flex space-x-2 mt-2 md:mt-0">
          <button class="time-filter active px-3 py-1 bg-dark-200 hover:bg-dark-300 text-gray-300 rounded-md text-sm transition-colors" data-range="30">30 Days</button>
          <button class="time-filter px-3 py-1 bg-dark-200 hover:bg-dark-300 text-gray-300 rounded-md text-sm transition-colors" data-range="90">90 Days</button>
          <button class="time-filter px-3 py-1 bg-dark-200 hover:bg-dark-300 text-gray-300 rounded-md text-sm transition-colors" data-range="365">1 Year</button>
        </div>
      </div>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
        <div>
          <label for="user-filter" class="block text-gray-300 mb-1 text-sm">User</label>
          <select id="user-filter" class="w-full bg-dark-300 border border-gray-600 rounded-md px-3 py-2 text-white text-sm focus:outline-none focus:border-neon-blue">
            <option value="all">All Users</option>
            <!-- This would be populated with actual users in a real implementation -->
            <option value="user1">User 1</option>
            <option value="user2">User 2</option>
            <option value="user3">User 3</option>
          </select>
        </div>
        
        <div>
          <label for="score-filter" class="block text-gray-300 mb-1 text-sm">Score Range</label>
          <select id="score-filter" class="w-full bg-dark-300 border border-gray-600 rounded-md px-3 py-2 text-white text-sm focus:outline-none focus:border-neon-blue">
            <option value="all">All Scores</option>
            <option value="high">High (80-100)</option>
            <option value="medium">Medium (60-79)</option>
            <option value="low">Low (0-59)</option>
          </select>
        </div>
        
        <div>
          <label for="website-filter" class="block text-gray-300 mb-1 text-sm">Website</label>
          <select id="website-filter" class="w-full bg-dark-300 border border-gray-600 rounded-md px-3 py-2 text-white text-sm focus:outline-none focus:border-neon-blue">
            <option value="all">All Websites</option>
            <!-- This would be populated with actual websites in a real implementation -->
            <option value="website1">Website 1</option>
            <option value="website2">Website 2</option>
            <option value="website3">Website 3</option>
          </select>
        </div>
      </div>
      
      <div class="mt-4 flex justify-end">
        <button id="apply-filters" class="px-4 py-2 bg-neon-blue text-white rounded-md hover:bg-blue-600 text-sm">
          Apply Filters
        </button>
      </div>
    </div>

    <!-- Score Distribution -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
      <div class="bg-dark-100 rounded-lg border border-gray-800 p-6">
        <h2 class="text-xl font-semibold mb-4">Score Distribution</h2>
        <div class="h-64">
          <canvas id="scoreDistributionChart"></canvas>
        </div>
      </div>
      
      <div class="bg-dark-100 rounded-lg border border-gray-800 p-6">
        <h2 class="text-xl font-semibold mb-4">Common Issues</h2>
        <div class="h-64">
          <canvas id="issuesChart"></canvas>
        </div>
      </div>
    </div>

    <!-- Top Performing Websites -->
    <div class="bg-dark-100 rounded-lg border border-gray-800 p-6 mb-8">
      <h2 class="text-xl font-semibold mb-4">Top Performing Websites</h2>
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-700">
          <thead class="bg-dark-200">
            <tr>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Website</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Average Score</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Analyses</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">Last Analysis</th>
              <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-400 uppercase tracking-wider">User</th>
            </tr>
          </thead>
          <tbody class="bg-dark-100 divide-y divide-gray-700">
            <!-- This would be populated with actual data in a real implementation -->
            <tr>
              <td class="px-6 py-4">
                <div class="text-sm text-white">example.com</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                  85/100
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">12</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">2023-04-10</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">User 1</div>
              </td>
            </tr>
            <tr>
              <td class="px-6 py-4">
                <div class="text-sm text-white">sample-site.com</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                  78/100
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">8</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">2023-04-09</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">User 2</div>
              </td>
            </tr>
            <tr>
              <td class="px-6 py-4">
                <div class="text-sm text-white">test-domain.org</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800">
                  72/100
                </span>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">5</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">2023-04-08</div>
              </td>
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="text-sm text-white">User 3</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Export Options -->
    <div class="bg-dark-100 rounded-lg border border-gray-800 p-6">
      <h2 class="text-xl font-semibold mb-4">Export Data</h2>
      <div class="flex flex-wrap gap-4">
        <button class="px-4 py-2 bg-dark-200 hover:bg-dark-300 text-gray-300 rounded-md transition-colors">
          <i class="fas fa-file-csv mr-2"></i> Export as CSV
        </button>
        <button class="px-4 py-2 bg-dark-200 hover:bg-dark-300 text-gray-300 rounded-md transition-colors">
          <i class="fas fa-file-excel mr-2"></i> Export as Excel
        </button>
        <button class="px-4 py-2 bg-dark-200 hover:bg-dark-300 text-gray-300 rounded-md transition-colors">
          <i class="fas fa-file-pdf mr-2"></i> Export as PDF
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Include Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Sample data for charts
    const dailyStats = <%= JSON.stringify(dailyStats) %>;
    
    // Parse the dates and prepare data for chart
    const dates = dailyStats.map(stat => stat.date);
    const counts = dailyStats.map(stat => stat.count);
    
    // Set up the usage chart
    const usageCtx = document.getElementById('usageChart').getContext('2d');
    const usageChart = new Chart(usageCtx, {
      type: 'line',
      data: {
        labels: dates,
        datasets: [{
          label: 'SEO Analyses',
          data: counts,
          backgroundColor: 'rgba(0, 242, 255, 0.2)',
          borderColor: 'rgba(0, 242, 255, 1)',
          borderWidth: 2,
          tension: 0.4,
          fill: true
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: 'rgba(255, 255, 255, 0.7)'
            }
          },
          x: {
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: 'rgba(255, 255, 255, 0.7)'
            }
          }
        },
        plugins: {
          legend: {
            labels: {
              color: 'rgba(255, 255, 255, 0.7)'
            }
          }
        }
      }
    });
    
    // Sample data for score distribution
    const scoreDistributionCtx = document.getElementById('scoreDistributionChart').getContext('2d');
    const scoreDistributionChart = new Chart(scoreDistributionCtx, {
      type: 'doughnut',
      data: {
        labels: ['High (80-100)', 'Medium (60-79)', 'Low (0-59)'],
        datasets: [{
          data: [45, 35, 20],
          backgroundColor: [
            'rgba(50, 205, 50, 0.7)',
            'rgba(255, 215, 0, 0.7)',
            'rgba(255, 69, 0, 0.7)'
          ],
          borderColor: [
            'rgba(50, 205, 50, 1)',
            'rgba(255, 215, 0, 1)',
            'rgba(255, 69, 0, 1)'
          ],
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: {
            position: 'right',
            labels: {
              color: 'rgba(255, 255, 255, 0.7)'
            }
          }
        }
      }
    });
    
    // Sample data for common issues
    const issuesCtx = document.getElementById('issuesChart').getContext('2d');
    const issuesChart = new Chart(issuesCtx, {
      type: 'bar',
      data: {
        labels: ['Missing Meta', 'Poor Title', 'No Headings', 'Keyword Issues', 'Content Length'],
        datasets: [{
          label: 'Frequency',
          data: [65, 59, 40, 35, 28],
          backgroundColor: 'rgba(138, 43, 226, 0.7)',
          borderColor: 'rgba(138, 43, 226, 1)',
          borderWidth: 1
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          y: {
            beginAtZero: true,
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: 'rgba(255, 255, 255, 0.7)'
            }
          },
          x: {
            grid: {
              color: 'rgba(255, 255, 255, 0.1)'
            },
            ticks: {
              color: 'rgba(255, 255, 255, 0.7)'
            }
          }
        },
        plugins: {
          legend: {
            labels: {
              color: 'rgba(255, 255, 255, 0.7)'
            }
          }
        }
      }
    });
    
    // Time filter buttons
    const timeFilters = document.querySelectorAll('.time-filter');
    timeFilters.forEach(filter => {
      filter.addEventListener('click', function() {
        // Remove active class from all filters
        timeFilters.forEach(f => f.classList.remove('active'));
        
        // Add active class to clicked filter
        this.classList.add('active');
        
        // Get the time range
        const range = parseInt(this.getAttribute('data-range'));
        
        // Update chart data (this would fetch new data in a real implementation)
        // For now, we'll just simulate different data
        const newData = [];
        for (let i = 0; i < range; i++) {
          const date = new Date();
          date.setDate(date.getDate() - i);
          newData.unshift({
            date: date.toISOString().split('T')[0],
            count: Math.floor(Math.random() * 10) + 1
          });
        }
        
        // Update chart
        usageChart.data.labels = newData.map(item => item.date);
        usageChart.data.datasets[0].data = newData.map(item => item.count);
        usageChart.update();
      });
    });
    
    // Apply filters button
    document.getElementById('apply-filters').addEventListener('click', function() {
      const user = document.getElementById('user-filter').value;
      const score = document.getElementById('score-filter').value;
      const website = document.getElementById('website-filter').value;
      
      // In a real implementation, this would fetch filtered data from the server
      // For now, we'll just show an alert with the selected filters
      alert(`Filters applied:\nUser: ${user}\nScore Range: ${score}\nWebsite: ${website}`);
      
      // Simulate updating charts with new data
      // This would be replaced with actual data in a real implementation
      scoreDistributionChart.data.datasets[0].data = [
        Math.floor(Math.random() * 30) + 30,
        Math.floor(Math.random() * 30) + 20,
        Math.floor(Math.random() * 30) + 10
      ];
      scoreDistributionChart.update();
      
      issuesChart.data.datasets[0].data = [
        Math.floor(Math.random() * 30) + 40,
        Math.floor(Math.random() * 30) + 30,
        Math.floor(Math.random() * 30) + 20,
        Math.floor(Math.random() * 30) + 20,
        Math.floor(Math.random() * 30) + 10
      ];
      issuesChart.update();
    });
  });
</script>
